# 字符串

JavaScript的字符串就是用`''`或`""`括起来的字符表示。

如果`'`本身也是一个字符，那就可以用`""`括起来，比如`"I'm OK"`包含的字符是`I`，`'`，`m`，空格，`O`，`K`这6个字符。

如果字符串内部既包含`'`又包含`"`怎么办？可以用转义字符`\`来标识，比如：

```javascript
var hello = "I\'m \"OK\"";
```

```shell
hello => I'm "OK"
```

ASCII字符可以以`\x##`形式的十六进制表示，例如：

```java
var a = "\x61";
```

```shell
a => a   61是97的16进制表示
```

还可以用`\u####`表示一个Unicode字符：

```javascript
// 貌似是 UTF-16码位
var b = "\u4F60\u597D";
```

```shell
b => 你好
```

多行字符串，由于多行字符串用`\n`写起来比较费事，所以最新的ES6标准新增了一种多行字符串的表示方法，用反引号 ` 表示

```javascript
var c = `first
second
third`;
```

```she
c =>
first
second
third
```

模板字符串，跟其他语言一样，直接用 + 号连接。

```java
var d = "world";
var e = "hello "+d;
```

```she
e => hello world
```

如果有很多变量需要连接，用`+`号就比较麻烦。ES6新增了一种模板字符串，表示方法和上面的多行字符串一样，用反引号`，但是它会自动替换字符串中的变量：

```javascript
var d = "world";
// 注意这里用反引号
var f = `hello ${d}`;
```

```shell
f => hello world
```

字符串的常见方法：

```javascript
var h = "hello world";
// 获取字符串的长度
var length = h.length;
// 字符串可以看作是数组
var index = h[2];
/*
* 需要特别注意的是，字符串是不可变的，
* 如果对字符串的某个索引赋值，
* 不会有任何错误，但是，也没有任何效果：
**/
h[1] = 'k';
/*
indexOf()会搜索指定字符串出现的位置,
没有找到指定的子串，返回-1
 */
var k = h.indexOf("world");
/* 
substring()返回指定索引区间的子串：
跟java语法差不多
*/
var sub = h.substring(0,2);
```

```shell
length => 11
index => "e"
h[1] => "e"
k => 6
sub => "he"
```

#### 模板字符串

传统的 JavaScript 语言，输出模板通常是这样写的：

```javascript
const string =  'There are <b>' + basket.count + '</b> ' +'items in your basket, ' +'<em>' + basket.onSale +'</em> are on sale!';
```

上面这种写法相当繁琐不方便，ES6 引入了模板字符串解决这个问题。

```javascript
const string= `
  There are <b>${basket.count}</b> items
   in your basket, <em>${basket.onSale}</em>
  are on sale!
`;
```

模板字符串（template string）是增强版的字符串，用反引号（`）标识。它可以当作普通字符串使用，也可以用来定义多行字符串，或者在字符串中嵌入变量。

大括号内部可以放入任意的 JavaScript 表达式，可以进行运算，以及引用对象属性。

模板字符串之中还能调用函数。

```javascript
function fn() {
  return "Hello World";
}

`foo ${fn()} bar`
// foo Hello World bar
```

如果大括号中的值不是字符串，将按照一般的规则转为字符串。比如，大括号中是一个对象，将默认调用对象的`toString`方法。

模板字符串甚至还能嵌套。

```javascript
const tmpl = addrs => `
  <table>
  ${addrs.map(addr => `
    <tr><td>${addr.first}</td></tr>
    <tr><td>${addr.last}</td></tr>
  `).join('')}
  </table>
`;
```

### repeat()方法

`repeat`方法返回一个新字符串，表示将原字符串重复`n`次。

```javascript
'x'.repeat(3) // "xxx"
'hello'.repeat(2) // "hellohello"
'na'.repeat(0) // ""
```

参数如果是小数，会被取整。

```javascript
'na'.repeat(2.9) // "nana"
```

如果`repeat`的参数是负数或者`Infinity`，会报错。

```javascript
'na'.repeat(Infinity)
// RangeError
'na'.repeat(-1)
// RangeError
```

参数`NaN`等同于 0。

```javascript
'na'.repeat(NaN) // ""
```

#### padStart,padEnd方法

ES2017 引入了字符串补全长度的功能。如果某个字符串不够指定长度，会在头部或尾部补全。`padStart()`用于头部补全，`padEnd()`用于尾部补全。

```javascript
'x'.padStart(5, 'ab') // 'ababx'
'x'.padStart(4, 'ab') // 'abax'

'x'.padEnd(5, 'ab') // 'xabab'
'x'.padEnd(4, 'ab') // 'xaba'
```

上面代码中，`padStart()`和`padEnd()`一共接受两个参数，第一个参数是字符串补全生效的最大长度，第二个参数是用来补全的字符串。

如果原字符串的长度，等于或大于最大长度，则字符串补全不生效，返回原字符串。

```javascript
'xxx'.padStart(2, 'ab') // 'xxx'
'xxx'.padEnd(2, 'ab') // 'xxx'
```

如果用来补全的字符串与原字符串，两者的长度之和超过了最大长度，则会截去超出位数的补全字符串。

```javascript
'abc'.padStart(10, '0123456789')
// '0123456abc'
```

如果省略第二个参数，默认使用空格补全长度。

```javascript
'x'.padStart(4) // '   x'
'x'.padEnd(4) // 'x   '
```

`padStart()`的常见用途是为数值补全指定位数。下面代码生成 10 位的数值字符串。

```javascript
'1'.padStart(10, '0') // "0000000001"
'12'.padStart(10, '0') // "0000000012"
'123456'.padStart(10, '0') // "0000123456"
```

#### trimStart,trimEnd方法

[ES2019](https://github.com/tc39/proposal-string-left-right-trim) 对字符串实例新增了`trimStart()`和`trimEnd()`这两个方法。它们的行为与`trim()`一致，`trimStart()`消除字符串头部的空格，`trimEnd()`消除尾部的空格。它们返回的都是新字符串，不会修改原始字符串。

```javascript
const s = '  abc  ';

s.trim() // "abc"
s.trimStart() // "abc  "
s.trimEnd() // "  abc"
```

